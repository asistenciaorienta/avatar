

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Live2D Cubism 4 Demo</title>
  <style>
    body { margin: 0; background: #ffffff; overflow: hidden; }
    canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; }
  </style>
</head>
<body>
  <!-- PIXI.js v5 compatible con pixi-live2d-display -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.3.12/pixi.min.js"></script>
  <!-- Live2D Cubism Core -->
  <script src="live2dcubismcore.min.js"></script>
  <!-- pixi-live2d-display (Cubism 4) -->
  <script src="https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/cubism4.min.js"></script>

  <script>
    const app = new PIXI.Application({
      view: document.createElement("canvas"),
      autoStart: true,
      resizeTo: window,
      backgroundAlpha: 0
    });
    document.body.appendChild(app.view);

    // Carga del modelo
    PIXI.live2d.Live2DModel.from("modelo290825_2/modelo290825_2.model3.json").then(model => {
      model.scale.set(0.25);

      // Centrar modelo
      model.x = (window.innerWidth - model.width * model.scale.x) / 2;
      model.y = (window.innerHeight - model.height * model.scale.y) / 2;

      app.stage.addChild(model);

      // Forzar ojos abiertos
      model.internalModel.coreModel.setParameterValueById("ParamEyeLOpen", 1.0);
      model.internalModel.coreModel.setParameterValueById("ParamEyeROpen", 1.0);

      // Hacer que al hacer click reproduzca animación de parpadeo
      fetch("modelo290825_2/Parpadear.motion3.json")
        .then(res => res.arrayBuffer())
        .then(buffer => {
          const motion = model.internalModel.motionManager.createMotion(buffer);
          if (!motion) throw new Error("Motion no válido");

          model.interactive = true;
          model.buttonMode = true;
          model.on("pointerdown", () => {
            model.internalModel.motionManager.startMotion(motion, false);
          });
        })
        .catch(err => {
          console.error("Error cargando animación:", err);
        });

    }).catch(err => {
      console.error("Error cargando modelo:", err);
    });
  </script>
</body>
</html>
